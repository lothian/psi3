\section{Geometry Optimization and Vibrational Frequency Analysis} \label{opt}

\PSIthree\ is capable of carrying out geometry optimizations (minimization
only, at present) for a variety of molecular structures using either analytic
and numerical energy gradients.  

When analytic gradients are available (see Table \ref{table:methods}),
\PSIthree\ will automatically generate and use redundant, simple internal
coordinates for carrying out the optimization.  These simple stretch, bend,
torsion, and linear bend coordinates may be read from the intco.dat file
or determined completely by distance criteria using the input geometry.
By default, optimization is performed in redundant internal coordinates
regardless of how the geometry was provided in the input.  Alternatively,
the user may specify zmat_simples=true, in which case the simple internal
coordinates will be taken from the ZMAT given in the input file.  Also,
the user may specify optimization in delocalized internal coordinates
with delocalize=true.  

Geometrical constraints may be imposed by the addition of a section
with nearly the same format as intco.dat.  For example, to fix the distance
between atoms 1 and 2, as well as the angle between atoms 2, 1 and 3
in an optimization, add the following to your input file.
fixed_intco: (
  stre = (
    (1 2)
  )
  bend = (
    (2 1 3)
  )
)
The constrained simple internals must be ones present (either manually or
automatically) among the simple internals in intco.dat.  Alternatively,
the z-matrix input format may be used to specify constrained optimizations.
If zmat_simples=true, then variables in the z-matrix which end in
a dollar sign will be taken as simple internals to be optimized, and
all other variables will be taken as simple internals to keep frozen.

For methods for which only energies are available, \PSIthree\ will use
symmetry-adapted delocalized internal coordinates to generate geometrical
displacements for computing finite-difference gradients. The simple
coordinates can be linearly combined by hand or automatically.  The goal
is to form 3N-6(5) symmetry-adapted internal coordinates.  The automated
delocalized coordinates may work for low-symmetry molecules without
linear angles, but has not been extensively tested.  For both analytic-
and finite-difference-gradient optimization methods, Hessian updates are
performed using the BFGS method.

\PSIthree\ is also capable of computing harmonic vibrational frequencies
for a number of different methods using energy points or analytic energy first or
second derivatives.  (At present, only RHF-SCF analytic second derivatives
are available.)  If analytic energy second derivatives are not available,
\PSIthree\ will generate displaced geometries along symmetry adapted cartesian
coordinates, compute the appropriate energies or first derivatives, and use finite-difference
methods to compute the Hessian.

The following keywords are pertinent for geometry optimizations and
vibrational frequency analyses:
\begin{description}
\item[JOBTYPE = string]\mbox{}\\
This keyword (described earlier in this manual) must be set to
{\tt OPT} for geometry optimizations and {\tt FREQ} for frequency analyses.
\item[DERTYPE = string]\mbox{}\\
This keyword (also described earlier) must be set to {\tt NONE} is only
energies are available for the chosen method and {\tt FIRST} if analytic
gradients are available.
\item[BFGS\_USE\_LAST = integer]\mbox{}\\ This keyword is used to specify
the number of gradient step for the BFGS update of the Hessian.  The default
is six.  
\end{description}
