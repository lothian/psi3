.TH optking 1 " 8 Jul, 1999" "" ""
.  \"
.  \" Notice of Document Modification
.  \"
.  \"   man page created by Rollin King, 8 Jul 99
.  \"
.  \"
.LP NAME
optking \- geometry optimization program

.LP 
\fBDESCRIPTION\fP
.LP
The program
.B optking
may be used to optimize geometries in internal coordinates
or to make internal coordinate displacements.  The following
sets of internal coordinates may be used:
.IP "1."
a set of internal coordinates may be provided by the user in
intco.dat.  The format is described in the \fBINTCO\fP
manpage and is the same as that used by \fBbmat\fP and \fBintder95\fP.
Only the \fBSTRE\fP, \fBBEND\fP, \fBTORS\fP, and \fBOUT\fP keywords
are currently supported by \fBoptking\fP.
.IP "2."
a redundant set of simple internal coordinates may be generated
by \fBoptking\fP
based on bond-connectivity (similar to Gaussian94).
.IP "3."
a set of symmetry-adapted (limited to D2h), nonredundant, delocalized internal
coordinates can be automatically generated by \fBoptking\fP.
These coordinates will become somewhat nonorthogonal as the geometry
changes during an optimization.  At least at this point, the
delocalization is not guaranteed to successfully complete and
provide SALC's.  Also, it will definitely not work with \fBinputth\fP
and the D2h point group.
.IP "4."
a set of coordinates similar to those above may be generated from
a set of simple internal coordinates provided by the user.

.LP
Force constants are read from fconst.dat, if possible,
or else are empirically generated.  Currently, the program
has no special transition state searching methods such
as any other Hessian update besides the BFGS update.

.LP
\fBChanges of Note:\fP
.IP "1."
The geometry is no longer written to geom.dat for a geometry
optimization.  The new displaced geometry is written directly
to file30.  If displacements are being done, then the new
geometries are still written to geom.dat.
.IP "2."
The
.B optking
program itself checks for convergence of the optimization procedure,
obviating the need for
.B gradtol 
or
.B gradconv.
.IP "3."
The files fconst.dat and intco.dat are now optional starting
files.  As a result, these files will be written to by \fBoptking\fP
as necessary.  The file intco.dat should have a last line containing
only ")" if you need \fBoptking\fP to supply coordinates.  The
file fconst.dat now stores your current
updated Hessian, so if Hessian updating is turned on, your
original fconst.dat will be lost. 
.IP "4."
Internal coordinates are only read from intco.dat--not from
input.dat
.IP "5."
To keep the keywords for
.B optking
short and simple, they are only read from the \fBOPTKING\fP section,
not the \fBDEFAULT\fP section of the input file.


.LP
\fBREFERENCES\fP
.IP "1."
Geometry optimization in redundant internal coordinates,
P. Pulay and G. Fogarasi, J. Chem. Phys. 96, 2856 (1992).
.IP "2."
Using redundant internal coordinates to optimize equilibrium
geometries and transition states, C. Peng, P. Y. Ayala, H. B. Schlegel,
and M. J. Frisch, J. Comp. Chem. 17, 49 (1996).
.IP "3."
The generation and use of delocalized internal coordinates
in geometry optimization, J. Baker, A. Kessi and B. Delley,
J. Chem. Phys. 105, 192 (1996).
.IP "4."
Estimating the Hessian for gradient-type geometry optimizations,
H. B. Schlegel, Theoret. Chim. Acta (Berl.) 66, 333 (1984).

.LP
\fBFILES REQUIRED\fP
.nf
    input.dat     \- input file
.fi

.LP
\fBOPTIONAL INPUT FILES\fP
.nf
    intco.dat     \- either just simple internals
                  \- or also linear combinations
    fconst.dat    \- Hessian or force constant matrix
    opt.aux       \- Hessian update information
.fi

.LP
\fBTEMPORARY FILES USED\fP
.nf
    none
.fi

.LP
\fBFILES UPDATED\fP
.nf
    intco.dat     \- if internals are not provided by user
    fconst.dat    \- stores current updated Hessian matrix
    output.dat    \- output file
.fi

.LP
\fBINPUT FORMAT\fP
.LP
No command-line arguments are currently available.

Input for this program is read from the \fBOPTKING\fP section of
the file input.dat.  The following keywords are valid:

.IP "\fBDISPLACEMENTS =\fP \fIvector of vectors\fP"
If
.B DISPLACMENTS
keyword is present, then a geometry optimization is not being performed,
but internal coordinate displacements are being made.  There is no default.
Each element of this vector is a vector consisting of internal coordinate
indices and displacement values.
The units of displacment are angstrom and radians.
For example, if you desire two
displacements, the first being a displacement of internal coordinate 1
by 0.01 angstroms, the second a combination of coordinate 1 displaced
by 0.01 angstroms and coordinate 2 by 0.05 angstroms, the \fBDISPLACEMENTS\fP
vector would be:
.DS
   displacements = (
     (1 0.01)
     (1 0.01 2 0.05)
   )
.DE

.IP "\fBCONV =\fP \fIinteger\fP"
The test for convergence of the geometry optimization is that the
maximum force on an internal coordinate (in aJ/Ang or aJ/Rad)
must be less than 10^(-\fBCONV\fP).  The default is 5.

.IP "\fBIRREP_TOL =\fP \fIinteger\fP"
If primitive internals are being delocalized, the eigenvectors
are checked to see if they transform as irreps of the point
group to within a tolerance of 10^(-\fBIRREP_TOL\fP).  The default is 8. 

.IP "\fBEV_TOL =\fP \fIinteger\fP"
When primitive internals are being delocalized there must be 3n-6
(linear 3n-5) nonzero eigenvalues of the G matrix corresponding to
nonredundant delocalized coordinates.  Eigenvalues greater than
10^(-\fBEV_TOL\fP) are considered nonzero.  The default is 5.

.IP "\fBREDUNDANT =\fP \fIboolean\fP"
If true, then redundant coordinates are allowed.  The default is false.

.IP "\fBDELOCALIZE =\fP \fIboolean\fP"
If true, then delocalized internals are generated.
If false, then redundant primitive internals are used.
The default is true.  If the \fBSYMM\fP vector is given
by the user, this keyword has no effect.

.IP "\fBSYMMETRY =\fP \fIstring\fP"
In order to delocalize coordinates, character table information is
required.  For compatibility to old-input, the keyword \fBSYMMETRY\fP
is searched for in the \fBDEFAULT\fP section.  If absent, it is read
from file30 (presumably successfully if input3.0 or later was used).

.IP "\fBBFGS =\fP \fIboolean\fP"
If true, then a BFGS Hessian update is performed when possible.
The default is true.

.IP "\fBMIX_TYPES =\fP \fIboolean\fP"
If true, then generated delocalized coordinates will mix all primitive
internal types.  The default is true.

.IP "\fBJUNK_30 =\fP \fIboolean\fP"
If true, then the last iterated geometry from the back-tranformation to
cartesian coordinates will be written to file30, even if the back-transformation
did not converge.

.IP "\fBBONDS =\fP \fIvector of atom pairs\fP"
This array contains bonds which need to be added to the primitive
internal coordinate set.

.IP "\fBNOBONDS =\fP \fIvector of atom pairs\fP"
This array contains bonds which need to be deleted from the primitive
internal coordinate set.  

.LP
The following print options provide additional
output.  They may help the user understand the workings
of the program (The default for each is false.)

.IP "\fBPRINT_SIMPLES =\fP \fIboolean\fP"
If simple internals are automatically generated, prints the related info.
.IP "\fBPRINT_PARAMS =\fP \fIboolean\fP"
prints values for all of the \fBoptking\fP input parameters.
.IP "\fBPRINT_DELOCALIZE =\fP \fIboolean\fP"
If automatic delocalized coordinates are formed, prints the related info.
.IP "\fBPRINT_SYMMETRY =\fP \fIboolean\fP"
prints an abundance of symmetry related information.

.LP
The following keywords are parameters for the back-transformation
from internal coordinates to cartesian coordinates.  These should
rarely be needed.
.IP "\fBBT_MAX_ITER =\fP \fIinteger\fP"
Maximum number of iterations.  Default is 100.
.IP "\fBBT_DQ_CONV =\fP \fIinteger\fP"
Subsequent changes in internal coordinates must be less than
10^(-\fBBT_DQ_CONV\fP).  The default is 11.
.IP "\fBBT_DX_CONV =\fP \fIinteger\fP"
Subsequent changes in cartesian coordinates must be less than
10^(-\fBBT_DX_CONV\fP).  The default is 11.
